# 题目描述

给出一棵由 $n$ 个点， $n - 1$ 条边构成的有根满二叉树，其中根为 $root$ 。

定义旋转为：**交换树中任意一个非叶子节点的两棵子树**。

求给出的有根满二叉树旋转**至多** $k$ 次后能达到的字典序最小前序遍历顺序或中序遍历顺序或后序遍历顺序。


# 输入格式

第一行包含 $1$ 个字符 $c$ ，若 $c = A$ 表示需要输出前序遍历顺序，若 $c = B$ 表示需要输出中序遍历顺序，若 $c = C$ 表示需要输出后遍历顺序。

第 $2$ 行包含 $3$ 个整数 $n,root,k$ 表示一颗 $n$ 个点， $n - 1$ 条边的满二叉树，它的根为 $root$ ，可以旋转至多 $k$ 次。

接下来 $n$ 行，每行包含 $2$ 个整数 $l$ 和 $r$ ，其中第 $i$ 行表示点 $i$ 的左子树的根为 $l$ ， 右子树的根为 $r$ （若 $l = 0$ 且 $r = 0$ ，表示这个点是满二叉树的叶子）。

# 输出格式

输出共一行， $n$ 个整数，表示需要给出的遍历顺序。

# 样例1

```input1
A
7 5 1
0 0
3 1
0 0
0 0
2 7
0 0
6 4
```

```output1
5 2 1 3 7 6 4
```

# 样例2

```input2
B
15 13 3
7 9
3 1
4 5
0 0
0 0
0 0
0 0
14 11
0 0
12 8
0 0
6 15
2 10
0 0
0 0
```

```output2
4 3 5 2 7 1 9 13 6 12 15 10 11 8 14
```

# 数据范围

对于 $20 \%$ 的数据，保证 $n \le 2 ^ {4} - 1$ 。

对于 $100 \%$ 的数据，保证 $c$ 为字符 $A,B,C$ 中的 $1$ 个， $n \le 2 ^ {17} - 1,0 \le k \le n$ 。